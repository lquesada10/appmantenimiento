<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Subir Evidencia</title>
    <style>
      body {
        font-family: sans-serif;
        padding: 20px;
        max-width: 600px;
        margin: auto;
      }
    </style>
    <script>
      async function subirArchivos(event) {
        event.preventDefault();

        const files = document.getElementById("evidencia").files;
        if (files.length === 0 || files.length > 6) {
          alert("Sube entre 1 y 6 archivos.");
          return;
        }

        const formData = {
          fileCount: files.length
        };

        for (let i = 0; i < files.length; i++) {
          const file = files[i];
          const reader = new FileReader();

          await new Promise((resolve, reject) => {
            reader.onload = () => {
              const base64 = reader.result.split(",")[1];
              formData[`file${i}`] = base64;
              formData[`fileName${i}`] = file.name;
              formData[`mimeType${i}`] = file.type;
              resolve();
            };
            reader.onerror = reject;
            reader.readAsDataURL(file);
          });
        }

        const response = await fetch("https://script.google.com/macros/s/AKfycbwysvw9MeaO8xrK1sZAqJ7GIdxhXrd1cl7jfrAPOgZml1r4ZLmwAKbD1dWrVBnuShgAyQ/exec", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(formData),
        });

        const result = await response.json();
        alert("Archivos subidos:\n" + result.links.join("\n"));
      }
    </script>
  </head>
  <body>
    <h2>ðŸ“Ž Subir Evidencia</h2>
    <form onsubmit="subirArchivos(event)">
      <label><strong>Selecciona archivos (mÃ¡x. 6):</strong></label><br />
      <input type="file" id="evidencia" multiple required /><br /><br />
      <button type="submit">Enviar</button>
    </form>
  </body>
</html>

